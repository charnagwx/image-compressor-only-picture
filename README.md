# 📸 图片处理工具

一个纯前端的图片压缩和证件照尺寸修改工具，所有操作都在浏览器本地完成，安全快速，无需上传到服务器。

## ✨ 主要功能

### 1. 图片压缩
- **三种压缩模式**：
  - **清晰度模式**：通过滑块或输入框设置清晰度（0%-100%），实时预览压缩效果
  - **指定大小模式**：设置目标文件大小（KB），自动调整压缩质量以达到目标大小
  - **指定像素模式**：设置最大宽度和高度（像素），保持宽高比的同时调整图片尺寸
- **单张压缩**：上传单张图片，实时预览原图和压缩后效果，支持放大和下载
- **批量压缩**：一次选择多张图片，统一压缩并支持批量下载（ZIP打包）
- **支持的格式**：JPG、PNG、WebP、AVIF、HEIC（HEIC格式会自动转换为JPEG）

### 2. 证件照尺寸修改
- **多种预设尺寸**：
  - 1寸 (295×413px)
  - 小1寸 (260×378px)
  - 大1寸 (390×567px)
  - 2寸 (413×579px)
  - 小2寸 (390×567px)
  - 大2寸 (413×626px)
  - 自定义尺寸
- **智能处理**：自动裁剪和缩放，保持宽高比，白色背景填充
- **预览和下载**：实时预览处理后的证件照，支持放大和下载

## 🚀 使用方法

### 基本使用

1. **打开网页**
   - 双击 `index.html` 用浏览器打开（推荐 Chrome、Edge、Firefox 等现代浏览器）
   - 或使用本地服务器（如 VSCode Live Server）运行

2. **压缩图片**
   - 切换到"压缩图片"标签
   - 拖拽图片到上传区域，或点击"选择图片"按钮
   - 选择压缩模式（清晰度/指定大小/指定像素）
   - 调整参数，实时查看压缩效果
   - 点击"下载图片"按钮保存压缩后的图片

3. **批量压缩**
   - 选择多张图片（按住 Ctrl/Cmd 键多选）
   - 图片会显示在批量列表中
   - 可以单独压缩每张图片，或点击"压缩全部"批量处理
   - 点击"下载全部 (ZIP)"打包下载所有压缩后的图片

4. **修改证件照尺寸**
   - 切换到"证件照尺寸修改"标签
   - 上传一张证件照
   - 选择证件照尺寸（预设或自定义）
   - 预览处理后的效果
   - 点击"下载证件照"保存

## 📋 功能特性

### 图片压缩功能
- ✅ 支持拖拽上传和点击选择
- ✅ 三种压缩模式（清晰度/指定大小/指定像素）
- ✅ 实时预览压缩效果
- ✅ 显示压缩比例、文件大小、图片尺寸
- ✅ 单张压缩：显示原图和压缩后图片预览
- ✅ 批量压缩：列表式交互，在列表中显示压缩结果
- ✅ 支持原图放大和删除
- ✅ 支持压缩后图片预览和下载
- ✅ 自动设置默认值（100%清晰度、原图大小、原图像素）

### 证件照功能
- ✅ 多种预设尺寸选择
- ✅ 自定义尺寸输入
- ✅ 智能裁剪和缩放
- ✅ 白色背景填充
- ✅ 实时预览
- ✅ 支持放大和下载

### 技术特性
- ✅ 纯前端实现，无需服务器
- ✅ 所有操作在浏览器本地完成，保护隐私
- ✅ 支持 HEIC/HEIF 格式（通过 heic2any 库转换）
- ✅ 响应式设计，适配不同屏幕尺寸
- ✅ 内存管理优化，自动清理临时对象

## 🛠️ 技术实现

### 技术栈
- **HTML5**：页面结构
- **CSS3**：样式和布局（使用 CSS 变量、Flexbox、Grid）
- **原生 JavaScript**：核心逻辑，无框架依赖
- **Canvas API**：图片处理和压缩
- **FileReader API**：读取本地文件
- **heic2any**：HEIC/HEIF 格式转换（CDN）
- **JSZip**：批量下载打包（CDN）

### 核心实现
- **图片压缩**：使用 `canvas.toBlob()` 方法，支持质量参数和尺寸调整
- **指定大小压缩**：使用二分查找算法，自动调整质量以达到目标文件大小
- **指定像素压缩**：计算缩放比例，保持宽高比，调整图片尺寸
- **批量处理**：异步处理多张图片，支持进度显示和错误处理
- **内存管理**：使用 `URL.revokeObjectURL()` 及时释放临时对象，防止内存泄漏

## 📁 文件结构

```
yasuotupian/
├── index.html      # 页面入口文件
├── style.css       # 样式文件
├── app.js          # 核心逻辑代码
└── README.md       # 说明文档（本文件）
```

## ⚙️ 配置说明

### 文件大小限制
- 默认单张图片最大 20MB
- 可在 `app.js` 中修改 `MAX_FILE_SIZE_MB` 常量

### 支持的图片格式
- JPEG / JPG
- PNG
- WebP
- AVIF
- HEIC / HEIF（自动转换为 JPEG）
- RAW（部分格式可能无法在浏览器中直接处理）

### 压缩参数
- **清晰度模式**：0-100%（默认 100%）
- **指定大小模式**：10-20480 KB（默认显示原图大小）
- **指定像素模式**：宽度和高度 100-10000 px（默认显示原图像素）

## 🔧 开发说明

### 运行方式
1. **直接打开**：双击 `index.html` 文件
2. **本地服务器**（推荐）：
   ```bash
   # Python 3
   python3 -m http.server 8000
   
   # Node.js (需要安装 http-server)
   npx http-server -p 8000
   ```
   然后访问 `http://localhost:8000`

### 修改样式
- 所有样式在 `style.css` 中
- 使用 CSS 变量定义主题颜色，便于修改
- 响应式设计，使用媒体查询适配移动端

### 修改逻辑
- 主要逻辑在 `app.js` 中
- 代码结构清晰，注释完善
- 使用模块化函数设计，便于维护和扩展

## 📝 更新日志

### 最新版本
- ✅ 支持三种压缩模式（清晰度/指定大小/指定像素）
- ✅ 支持批量压缩功能
- ✅ 批量压缩采用列表式交互，不显示预览区域
- ✅ 单张压缩保持预览区域显示
- ✅ 支持证件照尺寸修改功能
- ✅ 支持原图放大和删除功能
- ✅ 支持压缩后图片预览和下载
- ✅ 优化内存管理，防止内存泄漏
- ✅ 支持 HEIC/HEIF 格式转换
- ✅ 实时更新压缩结果信息

## 🎯 后续规划

可能的扩展功能：
- [ ] 支持更多图片格式（如 RAW 格式的更多变体）
- [ ] 添加压缩历史记录
- [ ] 支持主题切换（明亮/暗色模式）
- [ ] 多语言支持
- [ ] 添加图片编辑功能（裁剪、旋转等）
- [ ] 支持图片格式转换

## 📄 许可证

本项目为开源项目，可自由使用和修改。

## 💡 注意事项

1. **浏览器兼容性**：建议使用现代浏览器（Chrome、Edge、Firefox、Safari 最新版本）
2. **文件大小**：大文件处理可能需要一些时间，请耐心等待
3. **内存使用**：批量处理大量图片时，注意浏览器内存使用情况
4. **HEIC 格式**：需要网络连接加载 heic2any 库（使用 CDN）
5. **隐私安全**：所有处理都在本地完成，图片不会上传到任何服务器

---

**享受使用！如有问题或建议，欢迎反馈。** 🎉
